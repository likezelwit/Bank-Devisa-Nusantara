<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edukasi Keuangan Nasabah</title>
    
    <!-- Memuat CSS Global sesuai permintaan -->
    <link rel="stylesheet" href="../../global.css">

    <style>
        /* CSS Internal */
        :root {
            --primary-color: #0056b3; 
            --secondary-color: #ffd700; 
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --text-color: #333333;
            --transition-speed: 0.5s;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            overflow: hidden; 
            height: 100vh;
            width: 100vw;
        }

        .hidden {
            display: none !important;
            opacity: 0;
        }

        .fade-in {
            animation: fadeIn var(--transition-speed) forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        /* --- Loading Screen --- */
        #loading-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--card-bg);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            flex-direction: column;
        }

        .loader {
            border: 8px solid #f3f3f3;
            border-top: 8px solid var(--primary-color);
            border-radius: 50%;
            width: 60px; height: 60px;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* --- Welcome Screen --- */
        #welcome-screen {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%);
        }
        #welcome-screen h1 { font-size: 2.5rem; color: var(--primary-color); margin-bottom: 1rem; }
        #welcome-screen p { font-size: 1.2rem; margin-bottom: 2rem; max-width: 600px; }

        /* --- Lobby (Pilihan Kartu) --- */
        #lobby-screen {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: var(--bg-color);
            padding: 20px;
        }

        .cards-container {
            position: relative; /* Penting untuk posisi mutlak kartu */
            width: 100%;
            max-width: 900px;
            height: 450px; /* Tinggi container untuk menampung kartu */
            display: flex;
            justify-content: center;
            align-items: center;
            perspective: 1000px;
        }

        .card {
            background: var(--card-bg);
            width: 280px;
            height: 380px;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
            
            /* Setup Posisi Animasi */
            position: absolute; 
            left: 50%;
            top: 50%;
            margin-left: -140px; /* Setengah dari lebar kartu (280px / 2) */
            margin-top: -190px;  /* Setengah dari tinggi kartu (380px / 2) */
            
            transition: all 0.6s cubic-bezier(0.25, 0.8, 0.25, 1); /* Transisi halus */
            border: 2px solid transparent;
            z-index: 1;
        }

        .card img {
            width: 100%; 
            height: 150px; 
            object-fit: cover; /* Agar gambar tetap rapi dalam kotak */
            object-position: center;
            border-radius: 8px; 
            margin-bottom: 15px;
        }
        .card h3 { margin-bottom: 10px; color: var(--primary-color); }

        /* --- Logika Posisi Kartu (Animasi) --- */
        /* Posisi Kiri */
        .pos-left {
            transform: translateX(-320px) scale(0.85);
            opacity: 0.7;
            z-index: 1;
        }
        /* Posisi Tengah (Aktif) */
        .pos-center {
            transform: translateX(0) scale(1.1);
            opacity: 1;
            z-index: 10;
            border-color: var(--secondary-color);
            box-shadow: 0 20px 40px rgba(0,0,0,0.25);
        }
        /* Posisi Kanan */
        .pos-right {
            transform: translateX(320px) scale(0.85);
            opacity: 0.7;
            z-index: 1;
        }

        /* Efek Hover agar terasa interaktif */
        .card.pos-left:hover {
            transform: translateX(-280px) scale(0.95);
            opacity: 1;
            z-index: 5;
        }
        .card.pos-right:hover {
            transform: translateX(280px) scale(0.95);
            opacity: 1;
            z-index: 5;
        }

        /* Indikator dipilih (Border biru saat klik) */
        .card.selected {
            border-color: var(--primary-color);
            background-color: #eef6ff;
        }

        #lobby-actions { margin-top: 20px; z-index: 20; }

        /* --- Content Screen --- */
        #content-screen {
            height: 100vh;
            display: flex;
            flex-direction: column;
            background-color: var(--bg-color);
        }

        .content-header {
            padding: 15px 20px;
            background: var(--card-bg);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
        }

        .scroll-container {
            flex: 1; overflow-y: auto; padding: 20px;
            scroll-behavior: smooth;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) #ccc;
        }

        .content-body {
            max-width: 800px;
            margin: 0 auto;
            padding-bottom: 100px;
        }

        .content-section {
            background: white; padding: 30px; border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            opacity: 0; transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .content-section.visible { opacity: 1; transform: translateY(0); }
        .content-section img { width: 100%; border-radius: 8px; margin: 20px 0; display: block; }
        .content-section h2 { color: var(--primary-color); margin-bottom: 15px; border-bottom: 2px solid var(--secondary-color); padding-bottom: 10px; display: inline-block; }
        .content-section p { line-height: 1.8; margin-bottom: 15px; font-size: 1.1rem; }

        /* --- Quiz --- */
        .quiz-container {
            background: var(--primary-color); color: white; padding: 40px;
            border-radius: 16px; text-align: center; margin-top: 40px;
        }
        .quiz-options { display: flex; flex-direction: column; gap: 10px; margin-top: 20px; }
        .quiz-btn {
            background: white; color: var(--primary-color); padding: 15px;
            border: none; border-radius: 8px; font-size: 1rem; cursor: pointer; transition: background 0.3s;
        }
        .quiz-btn:hover { background: #f0f0f0; }

        /* --- Modal --- */
        #feedback-modal {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: white; padding: 30px; border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3); text-align: center;
            z-index: 2000; min-width: 300px; display: none;
        }
        .feedback-success { color: #28a745; }
        .feedback-error { color: #dc3545; }

        /* Responsiveness (Mobile) */
        @media (max-width: 768px) {
            .cards-container {
                height: auto;
                display: flex;
                flex-direction: column;
                gap: 20px;
                position: static; /* Matikan absolute positioning di mobile */
            }
            .card {
                position: static;
                margin: 0;
                transform: none !important; /* Matikan animasi swap di mobile */
                opacity: 1 !important;
                width: 90%;
                max-width: 320px;
                height: auto;
                min-height: 200px;
            }
            .card:hover { transform: none !important; }
            .card.selected { transform: scale(1.02) !important; }
        }
    </style>
</head>
<body>

    <div id="app">
        
        <!-- 1. Loading Screen -->
        <section id="loading-screen">
            <div class="loader"></div>
            <h2>Memuat Edukasi...</h2>
        </section>

        <!-- 2. Welcome Screen -->
        <section id="welcome-screen" class="hidden">
            <h1>Selamat Datang, Nasabah!</h1>
            <p>Temukan jawaban seputar uang, sejarahnya, dan perbedaan bentuknya di era digital. Mari belajar bersama.</p>
            <button class="btn btn-primary" onclick="navigateTo('lobby-screen')">Mulai Belajar</button>
        </section>

        <!-- 3. Lobby / Kartu Pilihan -->
        <section id="lobby-screen" class="hidden">
            <h2 style="margin-bottom: 30px; color: var(--primary-color);">Pilih Topik Pembahasan</h2>
            <div class="cards-container">
                <!-- Kartu 1: Apa Itu Uang -->
                <div class="card" id="card-0" onclick="selectCard(0)">
                    <!-- Gambar Lokal sesuai permintaan -->
                    <img src="../../ApaItuUang.webp" alt="Apa itu Uang">
                    <h3>Apa Itu Uang?</h3>
                    <p>Pengertian dasar dan fungsi uang dalam kehidupan sehari-hari.</p>
                </div>
                
                <!-- Kartu 2: Asal Usul Uang -->
                <div class="card" id="card-1" onclick="selectCard(1)">
                    <!-- Gambar Lokal sesuai permintaan -->
                    <img src="../../kantonguang.webp" alt="Asal Usul Uang">
                    <h3>Asal Usul Uang</h3>
                    <p>Bagaimana uang diciptakan dan sejarah perkembangannya.</p>
                </div>

                <!-- Kartu 3: Fisik vs Digital -->
                <div class="card" id="card-2" onclick="selectCard(2)">
                    <!-- Gambar Lokal sesuai permintaan -->
                    <img src="../../money.webp" alt="Uang Fisik vs Digital">
                    <h3>Fisik vs Digital</h3>
                    <p>Bedanya uang tunai dan uang digital yang modern.</p>
                </div>
            </div>

            <div id="lobby-actions">
                <button id="btn-enter" class="btn btn-primary" disabled onclick="enterTopic()">Masuk ke Materi</button>
            </div>
        </section>

        <!-- 4. Content Screen -->
        <section id="content-screen" class="hidden">
            <header class="content-header">
                <h3 id="topic-title">Judul Topik</h3>
                <button class="btn" style="background:#eee; font-size:0.8rem;" onclick="navigateTo('lobby-screen')">Kembali (Batal)</button>
            </header>
            
            <div class="scroll-container" id="scroll-container">
                <div class="content-body" id="content-body">
                    <!-- Konten JS -->
                </div>
            </div>
        </section>

    </div>

    <!-- Modal Feedback -->
    <div id="feedback-modal">
        <h3 id="feedback-title">Judul</h3>
        <p id="feedback-message">Pesan</p>
        <button class="btn btn-primary" onclick="closeFeedback()" style="margin-top:15px;">OK</button>
    </div>

    <script>
        // --- Data Materi (Gambar konten tetap placeholder/random agar variatif) ---
        const topics = [
            {
                id: 0,
                title: "Apa Itu Uang?",
                content: `
                    <div class="content-section">
                        <h2>Pengertian Uang</h2>
                        <p>Uang adalah benda yang diterima umum oleh masyarakat sebagai alat tukar-menukar barang dan jasa, serta sebagai alat pembayaran yang sah. Dalam ekonomi modern, uang memiliki fungsi yang sangat vital.</p>
                        <img src="https://picsum.photos/seed/money_concept/800/400" alt="Konsep Uang">
                    </div>
                    <div class="content-section">
                        <h2>Fungsi Utama Uang</h2>
                        <p>1. <strong>Medium of Exchange (Alat Tukar):</strong> Memudahkan transaksi daripada sistem barter.<br>
                        2. <strong>Unit of Account (Satuan Hitung):</strong> Menjadi standar harga bagi barang dan jasa.<br>
                        3. <strong>Store of Value (Penyimpan Nilai):</strong> Dapat disimpan untuk digunakan di masa depan.</p>
                    </div>
                    <div class="content-section">
                        <h2>Uang Dalam Kehidupan</h2>
                        <p>Tanpa uang, aktivitas ekonomi akan menjadi sangat lambat dan tidak efisien. Bayangkan jika Anda harus membawa gandum untuk membeli bensin!</p>
                        <img src="https://picsum.photos/seed/life/800/300" alt="Kehidupan Ekonomi">
                    </div>
                `,
                quiz: {
                    question: "Apa fungsi utama uang sebagai alat untuk menetapkan harga barang?",
                    options: ["Medium of Exchange", "Unit of Account", "Store of Value", "Barter"],
                    correct: 1
                }
            },
            {
                id: 1,
                title: "Sejarah & Penciptaan Uang",
                content: `
                    <div class="content-section">
                        <h2>Masa Barter</h2>
                        <p>Pada awalnya, manusia menggunakan sistem barter (tukar menukar barang). Namun, sistem ini memiliki kelemahan, seperti kesulitan menemukan orang yang memiliki barang yang kita inginkan dan ingin menukarnya dengan barang kita (double coincidence of wants).</p>
                        <img src="https://picsum.photos/seed/barter/800/400" alt="Barter">
                    </div>
                    <div class="content-section">
                        <h2>Uang Barang</h2>
                        <p>Untuk mengatasi masalah barter, manusia mulai menggunakan benda-benda tertentu yang bernilai dan disukai banyak orang sebagai uang, seperti kerang, garam, atau emas.</p>
                    </div>
                    <div class="content-section">
                        <h2>Uang Kertas & Bank</h2>
                        <p>Seiring waktu, bank mulai menerbitkan uang kertas yang merupakan bukti penyimpanan emas. Kini, uang kertas dan koin diterbitkan oleh Bank Sentral dan nilainya ditetapkan oleh kepercayaan (fiat money).</p>
                        <img src="https://picsum.photos/seed/coins/800/300" alt="Uang Kertas">
                    </div>
                `,
                quiz: {
                    question: "Apa kelemahan utama dari sistem barter?",
                    options: ["Barang mudah rusak", "Kesulitan mencocokkan kebutuhan (Double Coincidence of Wants)", "Harga terlalu mahal", "Tidak bisa disimpan"],
                    correct: 0
                }
            },
            {
                id: 2,
                title: "Uang Fisik vs Digital",
                content: `
                    <div class="content-section">
                        <h2>Uang Fisik (Cash)</h2>
                        <p>Uang fisik adalah uang yang berwujud nyata, seperti kertas dan logam (koin). Kelebihannya adalah dapat digunakan secara instan tanpa listrik atau internet, dan transaksinya anonim.</p>
                        <img src="https://picsum.photos/seed/cash/800/400" alt="Uang Tunai">
                    </div>
                    <div class="content-section">
                        <h2>Uang Digital (E-Money)</h2>
                        <p>Uang digital adalah nilai mata uang yang disimpan dalam media elektronik. Contohnya adalah saldo di bank, dompet elektronik (e-wallet), dan kripto. Kelebihannya adalah praktis, aman dari pencurian fisik, dan traceable.</p>
                        <img src="https://picsum.photos/seed/wallet/800/300" alt="Dompet Digital">
                    </div>
                    <div class="content-section">
                        <h2>Perbandingan</h2>
                        <p>Saat ini, keduanya saling melengkapi. Uang fisik seringkali digunakan untuk transaksi kecil, sedangkan uang digital mendominasi transaksi besar dan jarak jauh.</p>
                    </div>
                `,
                quiz: {
                    question: "Manakah yang merupakan kelebihan uang fisik?",
                    options: ["Bisa dipakai belanja online", "Transaksi anonim dan butuh listrik", "Transaksi anonim dan tidak butuh listrik/internet", "Aman dari perampokan"],
                    correct: 2
                }
            }
        ];

        // --- State Management ---
        let currentTopicId = null;
        
        // Menyimpan urutan ID kartu. 
        // Index 0 = Kiri, Index 1 = Tengah, Index 2 = Kanan
        let cardsOrder = [0, 1, 2]; 

        let autoScrollInterval = null;
        let isAutoScrolling = false;
        let scrollSpeed = 1;

        // --- Navigasi SPA ---
        function navigateTo(screenId) {
            document.querySelectorAll('section').forEach(sec => {
                sec.classList.add('hidden');
                sec.classList.remove('fade-in');
            });
            const target = document.getElementById(screenId);
            target.classList.remove('hidden');
            target.classList.add('fade-in');

            if (screenId === 'lobby-screen') {
                resetLobby();
            } else if (screenId === 'content-screen') {
                startAutoScroll();
            } else {
                stopAutoScroll();
            }
        }

        // --- Loading Logic ---
        window.addEventListener('load', () => {
            setTimeout(() => { navigateTo('welcome-screen'); }, 2000);
        });

        // --- Kartu Logic (MODIFIED) ---
        
        // Fungsi inisialisasi posisi kartu saat pertama kali masuk ke Lobby
        function renderCardPositions() {
            cardsOrder.forEach((cardId, index) => {
                const cardEl = document.getElementById(`card-${cardId}`);
                
                // Hapus semua kelas posisi
                cardEl.classList.remove('pos-left', 'pos-center', 'pos-right', 'selected');

                // Tambahkan kelas posisi berdasarkan index (0: kiri, 1: tengah, 2: kanan)
                if (index === 0) cardEl.classList.add('pos-left');
                if (index === 1) cardEl.classList.add('pos-center');
                if (index === 2) cardEl.classList.add('pos-right');
            });
        }

        function selectCard(cardId) {
            // Cari posisi kartu yang diklik dalam array saat ini
            const currentIndex = cardsOrder.indexOf(cardId);
            const centerIndex = 1; // Index tengah selalu 1

            // Jika kartu yang diklik SUDAH di tengah, langsang tandai selected
            if (currentIndex === centerIndex) {
                highlightCard(cardId);
                return;
            }

            // LOGIKA SWAP (PERTUKARAN):
            // Tukar kartu yang diklik dengan kartu yang ada di tengah
            // Contoh: [0, 1, 2]. Klik 2. Tukar index 2 dan index 1. Hasil: [0, 2, 1]
            [cardsOrder[currentIndex], cardsOrder[centerIndex]] = [cardsOrder[centerIndex], cardsOrder[currentIndex]];

            // Render ulang posisi dengan animasi CSS
            renderCardPositions();

            // Setelah animasi selesai (opsional), tandai kartu yang sekarang di tengah sebagai selected
            highlightCard(cardId);
        }

        function highlightCard(cardId) {
            // Hapus selected dari semua
            document.querySelectorAll('.card').forEach(c => c.classList.remove('selected'));
            
            // Tambah selected ke kartu target
            const targetCard = document.getElementById(`card-${cardId}`);
            targetCard.classList.add('selected');
            
            // Update State
            currentTopicId = cardId;
            
            // Enable Tombol
            const btn = document.getElementById('btn-enter');
            btn.disabled = false;
            btn.innerText = "Masuk ke Materi: " + topics[cardId].title;
        }

        function resetLobby() {
            // Reset urutan ke default
            cardsOrder = [0, 1, 2];
            renderCardPositions();
            
            currentTopicId = null;
            document.getElementById('btn-enter').disabled = true;
            document.getElementById('btn-enter').innerText = "Masuk ke Materi";
            stopAutoScroll();
        }

        function enterTopic() {
            if (currentTopicId === null) return;
            const topic = topics[currentTopicId];
            
            document.getElementById('topic-title').innerText = topic.title;
            const body = document.getElementById('content-body');
            body.innerHTML = topic.content + generateQuizHTML(topic.quiz);

            navigateTo('content-screen');
            setupScrollObserver();
        }

        // --- Auto Scroll Logic (Sama) ---
        const scrollContainer = document.getElementById('scroll-container');

        function startAutoScroll() {
            if (autoScrollInterval) clearInterval(autoScrollInterval);
            isAutoScrolling = true;
            
            autoScrollInterval = setInterval(() => {
                if (!isAutoScrolling) return;
                if ((scrollContainer.innerHeight + scrollContainer.scrollTop) >= scrollContainer.scrollHeight) {
                    stopAutoScroll(); 
                } else {
                    scrollContainer.scrollBy(0, scrollSpeed);
                }
            }, 50);
        }

        function stopAutoScroll() {
            isAutoScrolling = false;
            if (autoScrollInterval) {
                clearInterval(autoScrollInterval);
                autoScrollInterval = null;
            }
        }

        scrollContainer.addEventListener('mousedown', () => { stopAutoScroll(); });
        scrollContainer.addEventListener('touchstart', () => { stopAutoScroll(); });
        scrollContainer.addEventListener('wheel', () => { stopAutoScroll(); });

        let resumeTimeout;
        scrollContainer.addEventListener('mouseup', () => {
            clearTimeout(resumeTimeout);
            resumeTimeout = setTimeout(startAutoScroll, 2000);
        });
        scrollContainer.addEventListener('touchend', () => {
            clearTimeout(resumeTimeout);
            resumeTimeout = setTimeout(startAutoScroll, 2000);
        });
        scrollContainer.addEventListener('wheel', () => {
            clearTimeout(resumeTimeout);
            resumeTimeout = setTimeout(startAutoScroll, 2000);
        });

        function setupScrollObserver() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, { threshold: 0.1 });
            document.querySelectorAll('.content-section, .quiz-container').forEach(el => {
                observer.observe(el);
            });
        }

        // --- Quiz Logic (Sama) ---
        function generateQuizHTML(quizData) {
            let optionsHTML = '';
            quizData.options.forEach((opt, index) => {
                optionsHTML += `<button class="quiz-btn" onclick="checkAnswer(${index}, ${quizData.correct}, this)">${opt}</button>`;
            });
            return `
                <div class="quiz-container">
                    <h2>Kuis Pemahaman</h2>
                    <p>${quizData.question}</p>
                    <div class="quiz-options">${optionsHTML}</div>
                </div>
            `;
        }

        function checkAnswer(selectedIndex, correctIndex, btnElement) {
            const allBtns = document.querySelectorAll('.quiz-btn');
            allBtns.forEach(btn => btn.disabled = true);

            if (selectedIndex === correctIndex) {
                btnElement.style.backgroundColor = '#d4edda';
                btnElement.style.color = '#155724';
                showFeedback(true, "Jawaban Benar! Kembali ke lobby...");
                setTimeout(() => {
                    closeFeedback();
                    navigateTo('lobby-screen');
                }, 3000);
            } else {
                btnElement.style.backgroundColor = '#f8d7da';
                btnElement.style.color = '#721c24';
                showFeedback(false, "Jawaban salah. Coba lagi!");
                setTimeout(() => { allBtns.forEach(btn => btn.disabled = false); }, 1000);
            }
        }

        function showFeedback(isSuccess, message) {
            const modal = document.getElementById('feedback-modal');
            const title = document.getElementById('feedback-title');
            const msg = document.getElementById('feedback-message');
            if (isSuccess) {
                title.innerText = "Selamat!"; title.className = "feedback-success";
            } else {
                title.innerText = "Ups!"; title.className = "feedback-error";
            }
            msg.innerText = message;
            modal.style.display = 'block';
        }

        function closeFeedback() {
            document.getElementById('feedback-modal').style.display = 'none';
        }
        
        // --- Inisialisasi Awal ---
        // Panggil sekali di awal agar posisi kartu benar (agar tidak bug saat pertama load)
        // Tunggu sebentar sampai DOM siap
        setTimeout(renderCardPositions, 100);

    </script>
</body>
</html>
