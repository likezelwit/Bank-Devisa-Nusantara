<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | Bank Devisa Nusantara</title>
    <link rel="stylesheet" href="style.css">
</head>
<body style="display: block; padding: 20px;">
    <script>
        if(sessionStorage.getItem('isAuth') !== 'true') window.location.href = 'index.html';
    </script>

    <div style="max-width: 800px; margin: auto;">
        <header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
            <div class="logo">BANK<span>DEVISA</span></div>
            <button onclick="sessionStorage.clear(); location.reload();" style="padding: 8px 15px; border-radius: 8px; border: 1px solid #ddd; cursor: pointer;">Keluar</button>
        </header>

        <div style="background: var(--navy); color: white; padding: 30px; border-radius: 24px; margin-bottom: 20px;">
            <p style="opacity: 0.7; font-size: 0.8rem; margin-bottom: 5px;">Selamat Datang,</p>
            <h1 id="namaNasabah" style="font-size: 1.5rem; margin-bottom: 20px;">Memuat...</h1>
            <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px;">
                <p style="font-size: 0.7rem; opacity: 0.7;">SALDO EFEKTIF</p>
                <h2 id="saldoNasabah" style="font-size: 2rem; color: var(--gold);">Rp 0</h2>
            </div>
        </div>

        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
            <div class="login-card" style="max-width: none; padding: 20px;">
                <span style="font-size: 2rem;">ðŸ’¸</span>
                <h3 style="margin-top: 10px;">Transfer</h3>
            </div>
            <div class="login-card" style="max-width: none; padding: 20px;">
                <span style="font-size: 2rem;">ðŸ’³</span>
                <h3 style="margin-top: 10px;">Upgrade Kartu</h3>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getDatabase, ref, get, child } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDXYDqFmhO8nacuX-hVnNsXMmpeqwYlW7U",
            databaseURL: "https://wifist-d3588-default-rtdb.asia-southeast1.firebasedatabase.app/",
            projectId: "wifist-d3588"
        };
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        async function loadData() {
            const card = sessionStorage.getItem('userCard');
            const snap = await get(child(ref(db), `nasabah/${card}`));
            if(snap.exists()) {
                const data = snap.val();
                document.getElementById('namaNasabah').innerText = data.nama;
                document.getElementById('saldoNasabah').innerText = "Rp " + data.saldo.toLocaleString('id-ID');
            }
        }
        loadData();
    </script>
</body>
</html>
